<!doctype html>
<html>
<head>
    <title>Dash JS Player</title>
    <script type="text/javascript" src="https://cdn.bitmovin.com/analytics/web/2/bitmovinanalytics.min.js"></script>
    <style>
        video {
            width: 640px;
            height: 360px;
        }
    </style>
</head>
<body>
<div>
    <video id="video" controls></video>
</div>
<script type="text/javascript" src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
<script type="text/javascript">
  document.addEventListener('DOMContentLoaded', () => {
    const keyValues = window.location.search.substr(1).split('&')
    let experimentId, mode, alk, mpdURL
    keyValues.forEach(keyValueString => {
      let keyValueArray = keyValueString.split('=')
      switch (keyValueArray[0]) {
        case 'id':
          experimentId = keyValueArray[1]
          break
        case 'mode':
          mode = keyValueArray[1]
          break
        case 'alk':
          alk = keyValueArray[1]
          break
        case 'mpdURL':
          mpdURL = keyValueArray[1]
          break
      }
    })

    const video = document.getElementById('video')
    const time = new Date().getTime()
    const player = dashjs.MediaPlayer().create()
    new bitmovin.analytics.adapters.DashjsAdapter({
      key: alk,
      videoId: 'ppt-test',
      title: 'BigBuckBunny_6s_simple_2014_05_09',
      cdnProvider: 'S3',
      experimentName: experimentId,
      debug: mode
    }, player, { starttime: time })

    player.initialize(video, mpdURL, false)

    player.play()
  })
</script>
</body>
</html>
